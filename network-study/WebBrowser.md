# 웹 브라우저가 메세지를 만든다

## 목차
1. [HTTP 리퀘스트 메세지 작성](#HTTP-리퀘스트-메세지-작성)
2. [웹 서버의 IP 주소를 DNS 서버에 조회](#웹-서버의-IP-주소를-DNS-서버에-조회)

## HTTP 리퀘스트 메세지 작성

- URL
  - 네트워크 상에서 자원의 위치를 알리기 위한 규약
  - 도메인명, 경로, 포트번호 등 쓸 수 있음
  - 모든 URL은 맨 앞 문자열에 액세스 프로토콜을 포함함
    - 프로토콜 : 통신 동작의 규약
    - `http:`: 웹 서버, `FTP:`: FTP(파입 업/다운로드) 서버, `mailto:` 메일 ··· etc.

### 브라우저는 URL을 해독한다.
#### URL의 요소
  - `http:` + `\\` + `웹 서버명` + `/` + `디렉토리` + `/` + ··· + `파일명`
  - ✔️ **파일명** 생략 가능
    -  eg) `http://example.com/test/`
    - 서버에 미리 정의해야 함. (대체로 index.html)
  - ✔️ **디렉토리명** 생략 가능
    - eg) `http://example.com`
    - 루트 디렉토리에 미리 설정된 파일에 엑세스
  - ❔`/` 가 없는 경우엔?
    - eg) `http://example.com/test`
      - test라는 디렉토리가 있으면 디렉토리로, 파일이 있으면 파일로 간주함
        - 둘 다 있을 수 없음

### HTTP의 기본 개념
#### HTTP 프로토콜 
  - 클라이언트와 서버가 주고받는 메세지의 내용이나 순서를 정한 것
  - 클라이언트 → 서버 
    - 리퀘스트 메세지를 보냄
      - URI, METHOD
  - 서버 → 클라이언트
    - 응답 메세지를 보냄
      - Status Code
#### Request Message
  - Request Line
    - METHOD
      - GET, POST, PUT, DELETE ··· etc.
    - URI
    - HTTP 버전
  - 메세지 헤더
    - 요청의 부가적인 정보
      - 데이터의 종류, 날짜 ··· etc.
  - 메세지 본문
    - 메소드와 URI만으로 요청을 보낼 수 있는 경우엔 메세지 본문이 없을 수도 있음
#### Response Message
  - Status Line
    - HTTP 버전
    - Status Code
    - | code | desc      |
      |------|-----------|
      | 1XX  | 처리의 경과 상황 |
      | 2XX  | 정상 종료     |
      | 3XX  | 다른 조치 필요  |
      | 4XX  | 클라이언트 오류  |
      | 5XX  | 서버 오류     |

    - Status Message
      - OK, NOT FOUND ··· etc.
  - 메세지 헤더
  - 메세지 본문
    - `Content-Type: text/html`인 경우에 html 태그가 포함될 수 있음
      - 태그 안에 영상/사진 파일이 포함되어 있다면 브라우저는 파일을 읽기 위한 Request를 웹 서버에 보내게 됨.
        - 예를 들어 하나의 응답 메세지에 세 개의 사진이 포함되어 있다면 브라우저는 총 4번의 요청을 보내게 되는 것.


## 웹 서버의 IP 주소를 DNS 서버에 조회

HTTP 메세지를 만들면 브라우저가 OS에게 의뢰한다. (브라우저는 메세지를 네트워크에 송신하는 기능이 없음.) <br>
OS에게 송신을 의뢰할 땐 도메인명이 아닌 IP 주소로 의뢰해야 하므로, <br>
**도메인 명을 기반으로 IP 주소를 조사해야 함.**

### TCP/IP
서브넷을 라우터로 연결하여 전체 네트워크를 이룸
- 서브넷
  - 허브에 몇 대의 컴퓨터가 접속된 것
- 액세스 대상의 서버까지 메세지가 운반되는 과정
  - `메세지 전송` → `허브` → `라우터` → ··· → `허브` → `메세지 도착`


### IP 주소
- IP 주소 = 네트워크 번호 + 호스트 번호
  - 네트워크 번호 : 서브넷에 할당된 번호
  - 호스트 번호 : PC에 할당된 번호
- IP 주소는 8비트 씩 점으로 구분해서 10진수로 표시한 32비트의 디지털 데이터
  - eg) `10.11.12.13`
  - 어느 부분이 네트워크 번호인지 호스트 번호인지 구분하기 어려움
    - 필요에 따라 `넷마스크`라는 IP 주소를 덧붙일 수 있음.
- 호스트 번호 부분의 비트값이 전부 0일 때
  - **서브넷 자체를 의미**
- 호스트 번호 부분의 비트값이 전부 0일 때
  - **서브넷에 연결된 모든 PC에게 패킷 보냄**
- 넷마스크
  - 32비트의 디지털 데이터
  - 왼쪽에 1이 나열되고, 오른쪽에 0이 나열된 구조
    - `1` = **네트워크 번호** / `0` = **호스트 번호** 
    - eg) `11111111.11111111.11111111.00000000`
      - 24비트까지 네트워크 번호, 그 이후엔 호스트 번호라는 뜻
      - 1의 갯수를 10진수로 표현해서 쓰기도 함.
      - 위의 예시는 `24`와 동일한 의미

> 도메인과 IP 주소를 구분해서 쓰는 이유
> - 왜 도메인 대신 IP 주소를 쓸 수 없을까?
>   - 외우기 어렵고 사용성이 낮음
> - 왜 IP 주소 대신 도메인 주소만 쓸 수 없을까?
>   - IP 주소는 32비트, 도메인 주소는 적게는 수십, 많게는 255바이트의 문자를 취급
>   - 네트워크 부하되고 속도와 효율성이 저하됨.

### DNS 서버
- DNS 리졸버
  - 짧게 `리졸버`라고 부르기도 함
  - DNS 서버에 메세지를 보내고 응답 메세지를 받는 역할을 함.
  - `소켓 라이브러리`에 있는 기능
    - OS가 제공하는 기능
- 리졸버를 이용하여 DNS 서버를 조회하는 과정
  1. 브라우저가 리졸버를 호출함.
  2. 리졸버가 요청 메세지를 만듦.
  3. 요청 메세지를 OS의 프로토콜 스택을 통해 전달함.
  4. 프로토콜 스택은 LAN 어댑터를 통해 DNS 서버에게 메세지를 전송.
  5. DNS 서버가 호스트 이름을 IP 주소로 해석하고, 응답 메세지를 생성하여 클라이언트에게 전송.
  6. 프로토콜 스택을 거쳐서 리졸버에게 전달됨.
  7. 리졸버는 IP 주소만 추출해서 브라우저에게 반환.


```agsl
✔️ DNS 서버의 IP는 PC에 미리 설정되어 있다!
```









